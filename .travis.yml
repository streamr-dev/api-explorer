language: node_js
node_js:
- '14'
sudo: true
branches:
  only:
  - master
  - "/^v\\d+\\.\\d+(\\.\\d+)?(-\\S*)?$/"
  - development
before_install:
- npm i -g npm@6.14.11
install:
- npm ci
jobs:
  include:
  - stage: Api-Explorer Build Staging
    env:
    - NODE_ENV=production
    - PUBLIC_PATH=https://api-explorer-staging.streamr.network
    - SWAGGER_PATH=
    script:
    - npm run vendor:icons-bundle
    - npm run webpack:build
  - stage: Api-Explorer Build Production
    if: NOT type IN (pull_request)
    env:
    - NODE_ENV=production
    - PUBLIC_PATH=
    - SWAGGER_PATH=https://streamr-dev.github.io/engine-and-editor/swagger.json
    script:
    - npm run vendor:icons-bundle
    - npm run webpack:build